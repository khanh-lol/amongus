local Http = game:GetService("HttpService")
local TeleportService = game:GetService("TeleportService")
local WebhookUrl = "https://discord.com/api/webhooks/1379321018929385472/SSAWjhUKLLu1heifUp4-NoPRiw0ty-tLp20dHIo7q6v8qUY3TuHvSA8A-NAFVRFqi5kv"
local executor = identifyexecutor() or "Unknown Executor"

-- Function to generate join script for current game
local function generateJoinScript(jobId)
    return "game:GetService('TeleportService'):TeleportToPlaceInstance(" ..
        game.PlaceId .. ", '" .. jobId .. "', game.Players.LocalPlayer)"
end

-- Function to get game name (try multiple methods)
local function getGameName()
    if game:GetService("MarketplaceService"):GetProductInfo then
        local success, result = pcall(function()
            return game:GetService("MarketplaceService"):GetProductInfo(game.PlaceId)
        end)
        if success then return result.Name end
    end
    
    if game:GetService("MarketplaceService"):GetProductInfo then
        return "Game Name Unavailable"
    end
    
    return game.Name ~= "ROBLOX" and game.Name or "Unnamed Game"
end

local function sendRequest()
    local player = game.Players.LocalPlayer
    local displayName = player and player.DisplayName or "N/A"
    local userName = player and player.Name or "N/A"
    local playerId = player and player.UserId or 0
    local gameName = getGameName()

    -- Generate sample join script
    local sampleJoinScript = generateJoinScript("JOB_ID_HERE")

    return {
        Url = WebhookUrl,
        Method = 'POST',
        Headers = {
            ['Content-Type'] = 'application/json'
        },
        Body = Http:JSONEncode({
            ["content"] = "**Thanks for using the script!**",
            ["embeds"] = {{
                ["author"] = {
                    ["name"] = "Zte hub Server"
                },
                ["title"] = userName .. " | " .. displayName,
                ["type"] = "rich",
                ["color"] = tonumber(0x00FF00),
                ["thumbnail"] = {
                    ["url"] = "https://api.newstargeted.com/roblox/users/v1/avatar-headshot?userid=" .. playerId .. "&size=720x720&format=Png&isCircular=false"
                },
                ["fields"] = {
                    {
                        ["name"] = "Executor",
                        ["value"] = "```" .. executor .. "```",
                        ["inline"] = true
                    },
                    {
                        ["name"] = "Game",
                        ["value"] = "```" .. gameName .. "```",
                        ["inline"] = true
                    },
                    {
                        ["name"] = "Place ID",
                        ["value"] = "```" .. game.PlaceId .. "```",
                        ["inline"] = true
                    },
                    {
                        ["name"] = "Join Script",
                        ["value"] = "```lua\n" .. sampleJoinScript .. "\n```",
                        ["inline"] = false
                    }
                }
            }}
        })
    }
end

-- Universal request handler
local function makeRequest()
    local requestFunc = syn and syn.request or http_request or request or fluxus and fluxus.request or http and http.request
    if requestFunc then
        requestFunc(sendRequest())
    else
        warn("HTTP Request function not found")
    end
end

makeRequest()
